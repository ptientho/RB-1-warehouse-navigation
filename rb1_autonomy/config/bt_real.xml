<root BTCPP_format="4">
    <BehaviorTree ID="MainTree">
        <ReactiveSequence>
            <!--implement battery checking-->

            <ReactiveSequence>
                <ReactiveFallback>
                    <CheckShelfAttached name="check_attach_shelf" shelf_attached="{is_attached}"/>
                    <Sequence>
                        <Sequence>
                            <ShelfDetectorReal name="shelf_detection_client" shelf_pose="{front_shelf}" find_shelf="{is_found}"/>
                            <GoToPose2 name="go_to_shelf" pose="{front_shelf}"/>
                        </Sequence>
                        <ReactiveSequence>
                            <CheckShelfFound name="check_shelf_found" shelf_found="{is_found}"/>
                            <AttachShelf name="attach_shelf_client" is_success="{is_attached}"/>
                        </ReactiveSequence>
                    </Sequence>
                </ReactiveFallback>
                <Fallback>
                    <GoToPose name="go_to_desired_location" loc="desired_location"/>
                    <Sequence>
                        <BackUp name="backup_recovery"/>
                        <GoToPose name="go_to_desired_location" loc="desired_location"/>
                    </Sequence>
                </Fallback>
                <DetachShelf name="detach_shelf" detach_shelf="true" is_success="{!is_attached}"/>
            </ReactiveSequence>
        </ReactiveSequence>
    </BehaviorTree>
</root>